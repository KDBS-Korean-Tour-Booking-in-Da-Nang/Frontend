# 3.8 Admin Dashboard Module

## 3.8.1 View List Of Users

**Function Trigger:** The function is triggered when an ADMIN navigates to the user management page.

**Screen Layout**

Figure 81 Users List Screen (Admin)

**Function Description:** The function displays all users in the system, showing user information, roles, status, and allowing admins to manage users.

**Function Details:**

**Data:** The system displays:

- User ID
- Username
- Email
- Role (USER, COMPANY, STAFF, ADMIN)
- Status (UNBANNED, BANNED, UNVERIFIED, COMPANY_PENDING, WAITING_FOR_APPROVAL)
- Registration date
- Last login date
- Account balance

**Validation:**

- User must have ADMIN role
- Users are displayed with pagination
- Users can be filtered by role and status

**Business Rules:** BR-64

**Normal & Abnormal Cases:**

**Normal:**

- Users list is loaded successfully
- All user information is displayed
- Admin can filter and search users
- Admin can view user details

**Abnormal:**

- User not authenticated
- User not ADMIN role
- Network error
- Users fail to load

---

## 3.8.2 View List Of Reports

**Function Trigger:** The function is triggered when an ADMIN or STAFF navigates to the reports management page.

**Screen Layout**

Figure 82 Reports List Screen (Admin/Staff)

**Function Description:** The function displays all reports submitted by users for forum posts and comments. Admins/staff can review and resolve reports.

**Function Details:**

**Data:** The system displays:

- Report ID
- Reporter information
- Target type (POST or COMMENT)
- Target ID and preview
- Report reason
- Report status (PENDING, INVESTIGATING, RESOLVED, DISMISSED, CLOSED)
- Report date
- Resolution information (if resolved)

**Validation:**

- User must have ADMIN or STAFF role
- Staff must have task: FORUM_REPORT_AND_BOOKING_COMPLAINT
- Reports are paginated
- Reports can be filtered by status

**Business Rules:** BR-65

**Normal & Abnormal Cases:**

**Normal:**

- Reports are loaded successfully
- Reports are displayed with all information
- Admin/staff can click report to view details
- Report statistics are displayed

**Abnormal:**

- User not authenticated
- User not authorized
- Network error
- Reports fail to load

---

## 3.8.3 View System Transaction

**Function Trigger:** The function is triggered when an ADMIN navigates to the transactions page.

**Screen Layout**

Figure 83 System Transactions Screen (Admin)

**Function Description:** The function displays all financial transactions in the system, including payments, refunds, and revenue distribution.

**Function Details:**

**Data:** The system displays:

- Transaction ID
- Order ID
- User information
- Transaction amount
- Transaction status
- Transaction type
- Transaction date
- Order information
- Revenue distribution (company share, admin share)

**Validation:**

- User must have ADMIN role
- Transactions are displayed with pagination
- Transactions can be filtered by status and date

**Business Rules:** BR-66

**Normal & Abnormal Cases:**

**Normal:**

- Transactions are loaded successfully
- All transaction details are displayed
- Admin can view transaction statistics
- Admin can filter transactions

**Abnormal:**

- User not authenticated
- User not ADMIN role
- Network error
- Transactions fail to load

---

## 3.8.4 Create Staff Account

**Function Trigger:** The function is triggered when an ADMIN navigates to staff management and clicks "Create Staff" button.

**Screen Layout**

Figure 84 Create Staff Account Form

**Function Description:** The function allows admins to create new staff accounts with specific tasks/permissions. Staff accounts can perform administrative tasks based on their assigned tasks.

**Function Details:**

**Data:** Admins can provide:

- Username (unique)
- Email (unique)
- Password
- Staff tasks (array of tasks):
  - APPROVE_TOUR_BOOKING_AND_APPROVE_ARTICLE
  - FORUM_REPORT_AND_BOOKING_COMPLAINT
  - Other tasks as defined

**Validation:**

- User must have ADMIN role
- Username must be unique
- Email must be unique
- Password must meet requirements
- At least one staff task must be assigned

**Business Rules:** BR-67

**Normal & Abnormal Cases:**

**Normal:**

- Staff account created successfully
- Staff has role STAFF
- Staff tasks are assigned
- Staff can login with username
- A toast message is displayed: "Staff account created successfully"

**Abnormal:**

- Username already exists
- Email already exists
- Invalid password
- No tasks assigned
- Network error
- A toast message is displayed with appropriate error

---

## 3.8.5 Delete Staff Account

**Function Trigger:** The function is triggered when an ADMIN clicks "Delete Staff" button on a staff account.

**Screen Layout**

Figure 85 Delete Staff Confirmation

**Function Description:** The function allows admins to delete staff accounts. Deleted staff accounts can no longer access the system.

**Function Details:**

**Data:** System processes:

- Staff ID
- Admin confirmation

**Validation:**

- User must have ADMIN role
- Staff account must exist
- Cannot delete own account (if admin is also staff)

**Business Rules:** BR-68

**Normal & Abnormal Cases:**

**Normal:**

- Staff account deleted successfully
- Staff can no longer login
- A toast message is displayed: "Staff account deleted successfully"
- Staff is removed from staff list

**Abnormal:**

- Staff account not found
- User not authorized
- Network error
- A toast message is displayed with appropriate error

---

## 3.8.6 Update Staff's Task

**Function Trigger:** The function is triggered when an ADMIN clicks "Edit Tasks" on a staff account.

**Screen Layout**

Figure 86 Update Staff Tasks Form

**Function Description:** The function allows admins to update the tasks/permissions assigned to staff accounts. Staff tasks determine what administrative functions staff can perform.

**Function Details:**

**Data:** Admins can update:

- Staff ID
- New staff tasks (array)

**Validation:**

- User must have ADMIN role
- Staff account must exist
- At least one task must be assigned

**Business Rules:** BR-69

**Normal & Abnormal Cases:**

**Normal:**

- Staff tasks updated successfully
- Staff permissions are updated
- A toast message is displayed: "Staff tasks updated successfully"
- Staff can now perform new tasks

**Abnormal:**

- Staff account not found
- No tasks assigned
- User not authorized
- Network error

---

## 3.8.7 Change User Status

**Function Trigger:** The function is triggered when an ADMIN or STAFF clicks "Ban User" or "Unban User" button on a user account.

**Screen Layout**

Figure 87 Change User Status Modal

**Function Description:** The function allows admins/staff to ban or unban users. Banned users cannot login or use the system. Admins can also change user roles.

**Function Details:**

**Data:** Admins/staff can provide:

- User ID
- Ban status (true/false)
- Ban reason (optional)
- New role (optional, for role changes)

**Validation:**

- User must have ADMIN or STAFF role
- User account must exist
- Cannot ban/unban own account
- Cannot change own role

**Business Rules:** BR-70

**Normal & Abnormal Cases:**

**Normal:**

- User status updated successfully
- If banned: User cannot login
- If unbanned: User can login again
- A toast message is displayed: "User status updated successfully"
- User status is reflected in user list

**Abnormal:**

- User account not found
- User not authorized
- Cannot modify own account
- Network error
- A toast message is displayed with appropriate error

---

## 3.8.8 Change Tour Status

**Function Trigger:** The function is triggered when an ADMIN or STAFF clicks "Approve Tour" or "Reject Tour" button on a tour.

**Screen Layout**

Figure 88 Change Tour Status (Admin/Staff)

**Function Description:** The function allows admins/staff to approve or reject tours created by companies. Approved tours become PUBLIC and visible to users.

**Function Details:**

**Data:** Admins/staff can change:

- Tour ID
- New status (PUBLIC, NOT_APPROVED, DISABLED)

**Validation:**

- User must have ADMIN or STAFF role
- Staff must have task: APPROVE_TOUR_BOOKING_AND_APPROVE_ARTICLE
- Tour must exist

**Business Rules:** BR-71

**Normal & Abnormal Cases:**

**Normal:**

- Tour status updated successfully
- If approved: Tour becomes PUBLIC and visible to users
- If rejected: Tour remains NOT_APPROVED
- Company is notified
- A toast message is displayed: "Tour status updated successfully"

**Abnormal:**

- Tour not found
- User not authorized
- Staff doesn't have required task
- Network error
- A toast message is displayed with appropriate error

---

## 3.8.9 Send Notifications

**Function Trigger:** The function is triggered when an ADMIN navigates to notification management and clicks "Send Notification" button.

**Screen Layout**

Figure 89 Send Notification Form (Admin)

**Function Description:** The function allows admins to send system-wide notifications to all users or specific user groups. Notifications are delivered via in-app notification and WebSocket.

**Function Details:**

**Data:** Admins can provide:

- Notification title
- Notification message
- Target users (all users, specific role, specific user)
- Notification type
- Optional target ID and type

**Validation:**

- User must have ADMIN role
- Title must not be empty
- Message must not be empty
- Target users must be valid

**Business Rules:** BR-72

**Normal & Abnormal Cases:**

**Normal:**

- Notification sent successfully
- Notification is delivered to target users
- Users receive notification via WebSocket
- Notification appears in users' notification list
- A toast message is displayed: "Notification sent successfully"

**Abnormal:**

- Title or message is empty
- Invalid target users
- Network error
- WebSocket delivery fails
- A toast message is displayed with appropriate error
## 3.8.10 View All Complaints

**Function Trigger:** The function is triggered when an ADMIN or authorized STAFF navigates to the booking complaints management page.

**Screen Layout**

Figure 90 Booking Complaints List Screen (Admin/Staff)

**Function Description:** The function displays all booking complaints created by users. Admins/staff can see complaint information, related bookings, and current resolution status to prioritize and handle cases.

**Function Details:**

**Data:** The system displays:

- Complaint ID  
- Booking ID  
- User (complainant) information  
- Complaint message/description  
- Complaint creation date  
- Booking information (tour, departure date, status)  
- Resolution type (if any)  
- Resolution date (if any)

**Validation:**

- User must have ADMIN or STAFF role  
- Staff must have appropriate task/permission to handle booking complaints  
- Complaints are paginated  
- Complaints can be filtered by status, date, or tour/company

**Business Rules:** BR-73

**Normal & Abnormal Cases:**

**Normal:**

- Complaints list is loaded successfully  
- Complaints are displayed with all key information  
- Admin/staff can filter and sort complaints  
- Admin/staff can click a complaint to view detailed information

**Abnormal:**

- User not authenticated  
- User not authorized  
- Network error  
- Complaints fail to load  

---

## 3.8.11 View Complaint Detail

**Function Trigger:** The function is triggered when an ADMIN or authorized STAFF selects a specific complaint from the complaints list to view its details.

**Screen Layout**

Figure 91 Complaint Detail Screen (Admin/Staff)

**Function Description:** The function displays full details of a specific booking complaint, including booking data, user information, complaint content, and current resolution state, serving as the basis for making resolution decisions.

**Function Details:**

**Data:** The system displays:

- Complaint ID  
- Booking ID and booking summary (tour, dates, guests, amount, status)  
- Complainant information (user)  
- Complaint message/description  
- Complaint creation date  
- Related booking history/status transitions  
- Current resolution type and resolution note (if already resolved)  
- Resolution date and staff who resolved (if already resolved)

**Validation:**

- User must have ADMIN or STAFF role  
- Staff must have appropriate task/permission  
- Complaint ID must exist  
- Booking linked to complaint must exist

**Business Rules:** BR-74

**Normal & Abnormal Cases:**

**Normal:**

- Complaint detail is loaded successfully  
- All complaint and booking information is displayed clearly  
- Admin/staff can navigate back to complaints list  
- Admin/staff can proceed to resolve complaint from this screen

**Abnormal:**

- Complaint not found  
- Booking related to complaint not found  
- User not authorized  
- Network error  

---

## 3.8.12 Resolve Booking Complaint

**Function Trigger:** The function is triggered when an ADMIN or authorized STAFF clicks the “Resolve Complaint” action on a specific complaint detail screen.

**Screen Layout**

Figure 92 Resolve Booking Complaint Modal

**Function Description:** The function allows admins/staff to resolve a booking complaint by selecting a resolution type (e.g., USER_FAULT, COMPANY_FAULT, NO_FAULT), updating booking status accordingly, and triggering revenue distribution if appropriate.

**Function Details:**

**Data:** Admins/staff can provide:

- Complaint ID  
- Resolution type (e.g., USER_FAULT, COMPANY_FAULT, NO_FAULT)  
- Optional resolution note/comment

**Validation:**

- User must have ADMIN or STAFF role  
- Staff must have task/permission: FORUM_REPORT_AND_BOOKING_COMPLAINT (hoặc nhiệm vụ tương đương được cấu hình)  
- Complaint must exist and not already be resolved  
- Resolution type must be a valid enum value  
- Booking linked to complaint must exist

**Business Rules:** BR-75

**Normal & Abnormal Cases:**

**Normal:**

- Complaint resolution is saved successfully  
- Complaint resolution type and resolved date are recorded  
- Booking status is updated based on resolution type (ví dụ: chuyển về BOOKING_SUCCESS nếu USER_FAULT hoặc NO_FAULT)  
- Revenue distribution logic is triggered khi cần (phân chia doanh thu giữa admin và company)  
- A toast message is displayed: “Complaint resolved successfully”

**Abnormal:**

- Complaint not found hoặc đã được resolve trước đó  
- Booking không tồn tại hoặc không phù hợp trạng thái để resolve  
- User không có quyền (không phải ADMIN/STAFF hoặc không có đúng task)  
- Network error  
- A toast message is displayed với lỗi phù hợp  